# ç®—æ³•è®¾è®¡ä¸åˆ†ææŠ¥å‘Š

> å®éªŒåç§°ï¼šU205602 éª‘å£«å‘¨æ¸¸åˆ—å›½é—®é¢˜

## é—®é¢˜é™ˆè¿°

åœ¨å¤§å°ä¸º`size * size`çš„æ–¹å½¢ç½‘æ ¼ä¸­ï¼Œæ¯ä¸ªæ ¼ç‚¹éƒ½æœ‰`visited`å’Œ`default`ä¸¤ä¸ªçŠ¶æ€ã€‚ä¸€ğŸä»`start:tuple[int,int]`ç‚¹å‡ºå‘ï¼ŒæŒ‰â€œæ—¥å­—â€èµ°ï¼Œåªå¯ä»¥èµ°çŠ¶æ€ä¸º`default`çš„ç‚¹ï¼Œæ¯æ¬¡èµ°ä¹‹å‰å°†å½“å‰æ ¼ç‚¹çŠ¶æ€èµ‹ä¸º`visited`ï¼Œç›´åˆ°æ‰€æœ‰ç‚¹éƒ½ä¸º`visited`ç»“æŸã€‚

## ç®—æ³•è®¾è®¡

è·å¾—`(x,y)`çš„æ—¥å­—é‚»åŸŸï¼š

```python
def neighbor(x, y):
    return [(x-1, y-2), (x+1, y-2), (x-1, y+2), (x+1, y+2), (x-2, y-1), (x+2, y-1), (x-2, y+1), (x+2, y+1)]
```

åˆ¤å®šæ˜¯å¦`(x,y)`åœ¨ç½‘æ ¼ä¸Šï¼š

```python
size = 8
def valid(x, y):
    return 0 <= x < size and 0 <= y < size
```

æä¾›å·²èµ°è¿‡çš„ç‚¹çš„é›†åˆ`visited:set[tuple[int,int]]`ï¼Œç»Ÿè®¡`(x,y)`å‘¨å›´å¯èµ°çš„ç‚¹çš„ä¸ªæ•°ï¼š

```python
def count(visited, x, y):
    return sum((xx, yy) not in visited and valid(xx, yy) for xx, yy in neighbor(x, y))
```

å½“ä¸Šä¸€æ­¥ä¸º`(x,y)`æ—¶ï¼ŒæŒ‰**å¯èµ°çš„ç‚¹çš„æ•°é‡**æ’åºï¼Œä¼˜å…ˆèµ°**å¯èµ°çš„ç‚¹å°‘**çš„ç‚¹ã€‚äºæ˜¯æ„é€ **æ’å¥½åºçš„åˆ—è¡¨**çš„å‡½æ•°ï¼š

```python
def find_bests(visited, x, y) -> list[tuple[int,int,int]]:
    return sorted(((count(visited, xx, yy), xx, yy) for xx, yy in neighbor(x, y) if (xx, yy) not in visited and valid(xx, yy)))
```

éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œè¿”å›å€¼åŒ…å«3ä¸ªæ•°ï¼Œå…¶ä¸­åä¸¤ä¸ªä»£è¡¨åæ ‡`x,y`å¦ä¸€ä¸ªæ˜¯ä¸ºäº†æ–¹ä¾¿æŒ‰å­—å…¸åºæ’åºè€ŒåŠ å…¥çš„**ä¸ªæ•°**å€¼ã€‚

---

ä¸»å‡½æ•°é‡‡ç”¨æ·±åº¦ä¼˜å…ˆæœç´¢ï¼Œè¿”å›**ä»è¿™ä¸ªç‚¹åˆ°æœ«å°¾çš„è·¯å¾„çš„åˆ—è¡¨**æˆ–`None`è¡¨ç¤º**æ­¤è·¯ä¸é€š**ã€‚å…·ä½“å®ç°å¦‚ä¸‹ï¼š

```python
def travel(visited, x, y):
    if len(visited) == size * size:
        return [(x, y)]
    for _, xx, yy in find_bests(visited, x, y):
        result = travel(visited | {(xx, yy)}, xx, yy)
        if result:
            return [(x, y)] + result
```

æœ€åï¼Œè¯»å–é¢˜ç›®è¾“å…¥å¹¶æŒ‰è¦æ±‚è¾“å‡ºè·¯å¾„ï¼š

```python
if __name__ == '__main__':
    x, y = map(int, input().split())
    world = [[0] * size for _ in range(size)]
    step = 0
    for i, j in travel({(x, y)}, x, y):
        step += 1
        world[i][j] = step
    else:
        print(*(' '.join(map(str, row)) for row in world), sep='\n')
```

## æ—¶é—´ç©ºé—´å¤æ‚åº¦åˆ†æ

- é—®é¢˜è§„æ¨¡nä¸ºæ£‹ç›˜çš„æ ¼ç‚¹æ•°
- æœ€å¥½æƒ…å†µä¸‹ï¼Œä¸ç”¨å›æº¯å°±èƒ½èµ°å®Œå…¨ç¨‹ï¼Œæ—¶é—´å¤æ‚åº¦ä¸º$O(n)$
- æœ€åæƒ…å†µä¸‹ï¼Œä¹Ÿä¸ä¼šè¶…è¿‡$8^{n}$ç§é€‰æ‹©ï¼Œå› æ­¤æ—¶é—´å¤æ‚åº¦ä¸º$O(8^{n})$
- å®æµ‹å‘ç°å‡ ä¹ä¸éœ€è¦å›æº¯ï¼Œå³å¹³å‡æ—¶é—´å¤æ‚åº¦åŸºæœ¬ä¸Šä¹Ÿæ˜¯$O(n)$

- ç©ºé—´å¤æ‚åº¦å§‹ç»ˆä¸ºé€’å½’æ·±åº¦ï¼Œå³$O(n)$

## ç¨‹åºå®ç°å’Œå®éªŒæµ‹è¯•

å®ç”¨`pytest-benchmark`æ¡†æ¶è¿›è¡Œæµ‹è¯•ï¼ˆæ¯ä¸ªå‡½æ•°çº¦30ä¸‡æ¬¡ï¼Œå…¶ä¸­20æ¬¡ä¸ºä¸€ç»„ï¼‰ï¼Œå…¶ä¸­`test_xy`æŒ‡çš„æ˜¯èµ·å§‹ç‚¹ä¸º`(x,y)`çš„æƒ…å†µ

<img src="benchmark_20220323_081517.svg" style="zoom:50%;" />

ä¼¼ä¹åªæœ‰å½“åˆå§‹ç‚¹ä¸º`(3,3)`æ—¶è§¦å‘äº†å›æº¯ï¼Œå…¶ä»–æƒ…å†µåˆ†å¸ƒè¾ƒä¸ºå¹³å‡ï¼Œä½†ä»¥`(0,3)`å’Œ`(1,2)`ä¸ºèµ·å§‹ç‚¹çš„æƒ…å†µçš„è€—æ—¶æ–¹å·®è¾ƒå¤§

<img src="benchmark_20220323_080632.svg" style="zoom:50%;" />

#### æ€»ç»“

æœ¬æ–‡è®¨è®ºäº†ä¸€ç§æœ´ç´ çš„è´ªå¿ƒç®—æ³•æ¥è§£å†³éª‘å£«å·¡æ¸¸é—®é¢˜ï¼Œå¹¶ä»ç†è®ºå’Œå®æµ‹çš„è§’åº¦å¯¹å®ƒè¿›è¡Œäº†å¤æ‚åº¦åˆ†æã€‚